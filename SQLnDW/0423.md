# SELECT 배우기

1. 예제 테이블 소개
    - 사용자 ID
    - 세션 ID
        - 세션 : 사용자의 방문을 논리적으로 나눈 것
        - 새로 방문할 때 생성
        - 방문 후 30분간 interaction 없다 새로 무언가를 할 때 생성
        - 하나의 사용자가 여러개의 세션을 가질 수 있음
        - 세션을 만들어낸 접점(경유지)를 채널이란 이름으로 기록
        - 세션이 생긴 시간도 기록
    - 마케팅 관련 사용자 트래픽 관련
    - DAU : 일간 
    - WAU : 주간 
    - MAU : 월간 Acive user

2. SQL
    - 다수의 SQL 문을 실행할 떈 세미콜론으로 분리
    - -- : 인라인 한줄짜리 주석
    - /* */ : 여러줄에 걸쳐 사용 가능한 주석
    - SQL 키워드는 대문자를 사용
    - DDL
        - CREATE TABLE 스키마.테이블이름(userid int, sessionid varchar(32) primary key, channel varchar(32));
        - CTAS: CREATE TABLE table_name AS SELECT 테이블을 만듦과 동시에 내용을 추가
        - DROP TABLE IF EXISTS table_name; : 테이블 삭제
        - ALTER TABLE 테이블이름 ADD COLUMN 필드이름 필드타입; 컬럼 추가
        - ALTER TABLE 테이블이름 RENAME 현재필드이름 to 새필드이름;
        - ALTER TABLE 테이블이름 DROP COLUMN 필드이름; 기존 컬럼 제거
        - ALTER TABLE 테이블이름 RENAME to 새테이블이름; 테이블이름 변경
    - DML
        - SELECT 필드1, 필드2 FROM 테이블이름;
            - WHERE 선택조건
                - WHERE 필드이름 (not) in ('변수1', '변수2')
                - LIKE : 대소문자 구분, WHERE 필드이름 LIKE 'G%' or 'G*'
                - ILIKE : 대소문자 구분 안함
                - BETWEEN : 범위 지정
            - GROUP BY 필드이름1, 필드이름2,
            - ORDER BY 필드이름 ASC/DESC
            - LIMIT N
            - DISTINCT 필드이름 : 설정한 필드를 중복 없이 한번만 보여줌
            - CASE WHEN 조건 THEN 참일때값 ELSE 거짓일때값 END 새필드이름
                - SELECT CASE WHEN channel in ('Facebook', 'Instagram') THEN 'Social-Media' WHEN channel in ('GOOGLE', 'NAVER') THEN 'Search-Engine' ELSE 'Something-Else' END channel-type FROM 테이블이름;
            - STRING Function
                - LEFT(필드이름, N) : N만큼 글자 자르기
                - REPLACE(필드이름, exp1, exp2) : epx1을 epx2로 대체
                - UPPER(필드이름) : 대무낮로
                - LOWER(필드이름) : 소문자로
                - LEN(필드이름) : 길이
                - LPAD, RPAD : 왼쪽이나 오른쪽에 스트링 패딩
                - SUBSTRING : LEFT 함수와 비슷하나 시작점을 줄 수 있다
            - DATE Conversion
                - 타임존 관련 변환 : CONVERT_TIMEZONE('America/Los_Angeles', ts), select pg_timezone_names()로 확인 가능
                - DATE, TRUNCATE : 날짜만 리턴, 시간 분 초는 자름
                - DATE_TRUNC
                - EXTRACT, DATE_PART : 날짜에서 특정 부분 값 추출 가능
                - DATEDIFF : 시간차이
                - DATEADD : 시간 더하기
                - GET_CUREENT : 현재시각
                - TO_CHAR : 문자열로 변경
                - TO_TIMESTAMP : 문자열을 시간으로 변경
            - CAST : CAST(필드이름 as float) - 필드의 타입을 변경 / 필드이름:::float
        - INSERT INTO : 레코드 추가
        - UPDATE FROM : 필드 값 수정
        - DELETE FROM : 레코드 삭제
        - TRUNCATE : DELETE FROM과 동일한 기능이나 TRANSACTION에 사용 불가능

3. SQL 실습 환경 소개
    - 데이터 확인 방법
        - 중복된 레코드 체크
        - 최근 데이터 존재 여부 체크
        - Primary key uniqueness 체크
        - 값이 비어있는 컬럼 체크